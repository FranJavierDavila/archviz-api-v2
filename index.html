<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ArchViz Prompt Builder</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            slate: {
              950: '#020617',
              900: '#0f172a',
              800: '#1e293b',
              700: '#334155',
              600: '#475569',
              500: '#64748b',
              400: '#94a3b8',
              300: '#cbd5e1',
              200: '#e2e8f0',
              100: '#f1f5f9',
            }
          }
        }
      }
    }

  </script>
  <style>
    body { background: linear-gradient(to bottom right, #020617, #0f172a, #020617); }
    .custom-scrollbar::-webkit-scrollbar { width: 6px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #1e293b; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #475569; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #64748b; }
    .tab-active { background: linear-gradient(to right, var(--tab-color), var(--tab-color-end)); color: white; box-shadow: 0 10px 25px -5px var(--tab-shadow); }
    .card-hover:hover { background: rgba(30, 41, 59, 0.7); }
    @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
    .fade-in { animation: fade-in 0.3s ease-out; }
    .model-card { transition: all 0.3s ease; cursor: pointer; }
    .model-card:hover { transform: translateY(-2px); }
    .model-card.selected { border-color: var(--model-color) !important; box-shadow: 0 0 25px var(--model-shadow); background: linear-gradient(135deg, var(--model-bg), transparent); }
  </style>
</head>
<body class="min-h-screen text-slate-200">
  
  <!-- Header -->
  <header class="relative overflow-hidden border-b border-white/10">
    <div class="absolute inset-0 bg-gradient-to-r from-cyan-500/10 via-violet-500/10 to-rose-500/10"></div>
    <div class="relative max-w-7xl mx-auto px-4 py-6">
      <div class="flex items-center justify-center gap-4">
        <div class="p-3 rounded-2xl bg-gradient-to-br from-cyan-500 to-violet-500 shadow-lg shadow-cyan-500/25">
          <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
          </svg>
        </div>
        <div class="text-center">
          <h1 class="text-2xl md:text-3xl font-bold bg-gradient-to-r from-cyan-400 via-violet-400 to-rose-400 bg-clip-text text-transparent">
            ArchViz Prompt Builder
          </h1>
          <p class="text-slate-400 mt-1 text-sm">Genera prompts profesionales para visualización arquitectónica</p>
        </div>
      </div>
      
      <!-- API Key Section -->
      <div class="mt-4 max-w-md mx-auto">
        <div class="flex items-center gap-2 bg-slate-800/50 border border-slate-700/50 rounded-xl p-2">
          <svg class="w-5 h-5 text-slate-400 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/>
          </svg>
          <input type="text" id="apiKey" placeholder="API Key (opcional)" class="flex-1 bg-transparent border-none text-slate-300 text-sm focus:outline-none placeholder:text-slate-500">
          <button onclick="validateApiKey()" class="px-3 py-1.5 bg-violet-500/20 hover:bg-violet-500/30 text-violet-300 rounded-lg text-sm transition-all">
            Validar
          </button>
        </div>
        <div id="apiStatus" class="hidden mt-2 text-center text-sm"></div>
      </div>
    </div>
  </header>

  <!-- Selected Engine Badge -->
  <div id="engineBadge" class="hidden max-w-7xl mx-auto px-4 py-2">
    <div class="flex items-center gap-2 text-sm">
      <span class="text-slate-400">Motor activo:</span>
      <span id="engineBadgeName" class="px-3 py-1 rounded-full bg-gradient-to-r font-medium"></span>
    </div>
  </div>

  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 py-4">
    
    <!-- Tabs -->
    <div class="flex flex-wrap justify-center gap-2 mb-6">
      <button onclick="showTab('motor')" id="tab-motor" class="tab-btn tab-active px-4 py-2.5 rounded-xl border border-slate-700/50 transition-all duration-300 hover:bg-slate-700/50 flex items-center gap-2" style="--tab-color: #8b5cf6; --tab-color-end: #a855f7; --tab-shadow: rgba(139, 92, 246, 0.25);">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
        Motor IA
      </button>
      <button onclick="showTab('configuracion')" id="tab-configuracion" class="tab-btn bg-slate-800/50 text-slate-300 px-4 py-2.5 rounded-xl border border-slate-700/50 transition-all duration-300 hover:bg-slate-700/50 flex items-center gap-2" style="--tab-color: #06b6d4; --tab-color-end: #14b8a6; --tab-shadow: rgba(6, 182, 212, 0.25);">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
        Configuración
      </button>
      <button onclick="showTab('escena')" id="tab-escena" class="tab-btn bg-slate-800/50 text-slate-300 px-4 py-2.5 rounded-xl border border-slate-700/50 transition-all duration-300 hover:bg-slate-700/50 flex items-center gap-2">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg>
        Escena
      </button>
      <button onclick="showTab('ambiente')" id="tab-ambiente" class="tab-btn bg-slate-800/50 text-slate-300 px-4 py-2.5 rounded-xl border border-slate-700/50 transition-all duration-300 hover:bg-slate-700/50 flex items-center gap-2">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
        Ambiente
      </button>
      <button onclick="showTab('camara')" id="tab-camara" class="tab-btn bg-slate-800/50 text-slate-300 px-4 py-2.5 rounded-xl border border-slate-700/50 transition-all duration-300 hover:bg-slate-700/50 flex items-center gap-2">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
        Cámara
      </button>
      <button onclick="showTab('avanzado')" id="tab-avanzado" class="tab-btn bg-slate-800/50 text-slate-300 px-4 py-2.5 rounded-xl border border-slate-700/50 transition-all duration-300 hover:bg-slate-700/50 flex items-center gap-2">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/></svg>
        Avanzado
      </button>
      <button onclick="showTab('plantillas')" id="tab-plantillas" class="tab-btn bg-slate-800/50 text-slate-300 px-4 py-2.5 rounded-xl border border-slate-700/50 transition-all duration-300 hover:bg-slate-700/50 flex items-center gap-2" style="--tab-color: #ec4899; --tab-color-end: #f472b6; --tab-shadow: rgba(236, 72, 153, 0.25);">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/></svg>
        Plantillas
      </button>
      <button onclick="showTab('ideas')" id="tab-ideas" class="tab-btn bg-slate-800/50 text-slate-300 px-4 py-2.5 rounded-xl border border-slate-700/50 transition-all duration-300 hover:bg-slate-700/50 flex items-center gap-2" style="--tab-color: #f59e0b; --tab-color-end: #f97316; --tab-shadow: rgba(245, 158, 11, 0.25);">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/></svg>
        Ideas
      </button>
    </div>

    <!-- Tab: Motor IA -->
    <div id="content-motor" class="tab-content fade-in">
      <div class="mb-6 text-center">
        <h2 class="text-xl font-semibold text-slate-200 mb-2">Selecciona el Motor de IA</h2>
        <p class="text-slate-400 text-sm">Cada motor tiene sus propios parámetros y formato de prompt</p>
      </div>
      
      <!-- Model Grid -->
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6">
        
        <!-- Midjourney -->
        <div onclick="selectEngine('midjourney')" class="model-card bg-slate-800/40 border-2 border-slate-600/50 rounded-xl p-4 text-center" style="--model-color: #5865F2; --model-shadow: rgba(88, 101, 242, 0.3); --model-bg: rgba(88, 101, 242, 0.1);">
          <div class="w-14 h-14 mx-auto mb-3 rounded-xl bg-gradient-to-br from-indigo-500 to-blue-600 flex items-center justify-center shadow-lg">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
          </div>
          <h3 class="font-semibold text-slate-100">Midjourney</h3>
          <p class="text-xs text-slate-500 mt-1">v6.1, v6, Niji 6</p>
          <div class="mt-2 flex justify-center gap-1">
            <span class="text-xs px-2 py-0.5 bg-indigo-500/20 text-indigo-300 rounded">Premium</span>
          </div>
        </div>

        <!-- Stable Diffusion -->
        <div onclick="selectEngine('stable_diffusion')" class="model-card bg-slate-800/40 border-2 border-slate-600/50 rounded-xl p-4 text-center" style="--model-color: #10B981; --model-shadow: rgba(16, 185, 129, 0.3); --model-bg: rgba(16, 185, 129, 0.1);">
          <div class="w-14 h-14 mx-auto mb-3 rounded-xl bg-gradient-to-br from-emerald-500 to-green-600 flex items-center justify-center shadow-lg">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
          </div>
          <h3 class="font-semibold text-slate-100">Stable Diffusion</h3>
          <p class="text-xs text-slate-500 mt-1">SDXL, SD 1.5, SD3</p>
          <div class="mt-2 flex justify-center gap-1">
            <span class="text-xs px-2 py-0.5 bg-emerald-500/20 text-emerald-300 rounded">Open Source</span>
          </div>
        </div>

        <!-- DALL-E -->
        <div onclick="selectEngine('dalle')" class="model-card bg-slate-800/40 border-2 border-slate-600/50 rounded-xl p-4 text-center" style="--model-color: #F59E0B; --model-shadow: rgba(245, 158, 11, 0.3); --model-bg: rgba(245, 158, 11, 0.1);">
          <div class="w-14 h-14 mx-auto mb-3 rounded-xl bg-gradient-to-br from-amber-500 to-orange-600 flex items-center justify-center shadow-lg">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/></svg>
          </div>
          <h3 class="font-semibold text-slate-100">DALL-E</h3>
          <p class="text-xs text-slate-500 mt-1">DALL-E 3</p>
          <div class="mt-2 flex justify-center gap-1">
            <span class="text-xs px-2 py-0.5 bg-amber-500/20 text-amber-300 rounded">OpenAI</span>
          </div>
        </div>

        <!-- Leonardo AI -->
        <div onclick="selectEngine('leonardo')" class="model-card bg-slate-800/40 border-2 border-slate-600/50 rounded-xl p-4 text-center" style="--model-color: #EC4899; --model-shadow: rgba(236, 72, 153, 0.3); --model-bg: rgba(236, 72, 153, 0.1);">
          <div class="w-14 h-14 mx-auto mb-3 rounded-xl bg-gradient-to-br from-pink-500 to-rose-600 flex items-center justify-center shadow-lg">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/></svg>
          </div>
          <h3 class="font-semibold text-slate-100">Leonardo AI</h3>
          <p class="text-xs text-slate-500 mt-1">Phoenix, SDXL</p>
          <div class="mt-2 flex justify-center gap-1">
            <span class="text-xs px-2 py-0.5 bg-pink-500/20 text-pink-300 rounded">Freemium</span>
          </div>
        </div>

        <!-- Flux -->
        <div onclick="selectEngine('flux')" class="model-card bg-slate-800/40 border-2 border-slate-600/50 rounded-xl p-4 text-center" style="--model-color: #06B6D4; --model-shadow: rgba(6, 182, 212, 0.3); --model-bg: rgba(6, 182, 212, 0.1);">
          <div class="w-14 h-14 mx-auto mb-3 rounded-xl bg-gradient-to-br from-cyan-500 to-teal-600 flex items-center justify-center shadow-lg">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
          </div>
          <h3 class="font-semibold text-slate-100">Flux</h3>
          <p class="text-xs text-slate-500 mt-1">Flux.1 Pro/Dev</p>
          <div class="mt-2 flex justify-center gap-1">
            <span class="text-xs px-2 py-0.5 bg-cyan-500/20 text-cyan-300 rounded">Black Forest</span>
          </div>
        </div>

        <!-- Ideogram -->
        <div onclick="selectEngine('ideogram')" class="model-card bg-slate-800/40 border-2 border-slate-600/50 rounded-xl p-4 text-center" style="--model-color: #8B5CF6; --model-shadow: rgba(139, 92, 246, 0.3); --model-bg: rgba(139, 92, 246, 0.1);">
          <div class="w-14 h-14 mx-auto mb-3 rounded-xl bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center shadow-lg">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"/></svg>
          </div>
          <h3 class="font-semibold text-slate-100">Ideogram</h3>
          <p class="text-xs text-slate-500 mt-1">Ideogram 2.0</p>
          <div class="mt-2 flex justify-center gap-1">
            <span class="text-xs px-2 py-0.5 bg-violet-500/20 text-violet-300 rounded">Texto</span>
          </div>
        </div>

        <!-- Nano Banana -->
        <div onclick="selectEngine('nano_banana')" class="model-card bg-slate-800/40 border-2 border-slate-600/50 rounded-xl p-4 text-center" style="--model-color: #EAB308; --model-shadow: rgba(234, 179, 8, 0.3); --model-bg: rgba(234, 179, 8, 0.1);">
          <div class="w-14 h-14 mx-auto mb-3 rounded-xl bg-gradient-to-br from-yellow-400 to-yellow-600 flex items-center justify-center shadow-lg">
            <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
          </div>
          <h3 class="font-semibold text-slate-100">Nano Banana</h3>
          <p class="text-xs text-slate-500 mt-1">Fal.ai</p>
          <div class="mt-2 flex justify-center gap-1">
            <span class="text-xs px-2 py-0.5 bg-yellow-500/20 text-yellow-300 rounded">Rápido</span>
          </div>
        </div>

        <!-- Recraft AI -->
        <div onclick="selectEngine('recraft')" class="model-card bg-slate-800/40 border-2 border-slate-600/50 rounded-xl p-4 text-center" style="--model-color: #14B8A6; --model-shadow: rgba(20, 184, 166, 0.3); --model-bg: rgba(20, 184, 166, 0.1);">
          <div class="w-14 h-14 mx-auto mb-3 rounded-xl bg-gradient-to-br from-teal-500 to-cyan-600 flex items-center justify-center shadow-lg">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/></svg>
          </div>
          <h3 class="font-semibold text-slate-100">Recraft AI</h3>
          <p class="text-xs text-slate-500 mt-1">Vector & Raster</p>
          <div class="mt-2 flex justify-center gap-1">
            <span class="text-xs px-2 py-0.5 bg-teal-500/20 text-teal-300 rounded">Diseño</span>
          </div>
        </div>

        <!-- Runway -->
        <div onclick="selectEngine('runway')" class="model-card bg-slate-800/40 border-2 border-slate-600/50 rounded-xl p-4 text-center" style="--model-color: #6366F1; --model-shadow: rgba(99, 102, 241, 0.3); --model-bg: rgba(99, 102, 241, 0.1);">
          <div class="w-14 h-14 mx-auto mb-3 rounded-xl bg-gradient-to-br from-indigo-500 to-blue-600 flex items-center justify-center shadow-lg">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
          </div>
          <h3 class="font-semibold text-slate-100">Runway</h3>
          <p class="text-xs text-slate-500 mt-1">Gen-3, Gen-2</p>
          <div class="mt-2 flex justify-center gap-1">
            <span class="text-xs px-2 py-0.5 bg-indigo-500/20 text-indigo-300 rounded">Video</span>
          </div>
        </div>

        <!-- Adobe Firefly -->
        <div onclick="selectEngine('firefly')" class="model-card bg-slate-800/40 border-2 border-slate-600/50 rounded-xl p-4 text-center" style="--model-color: #EF4444; --model-shadow: rgba(239, 68, 68, 0.3); --model-bg: rgba(239, 68, 68, 0.1);">
          <div class="w-14 h-14 mx-auto mb-3 rounded-xl bg-gradient-to-br from-red-500 to-orange-600 flex items-center justify-center shadow-lg">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.879 16.121A3 3 0 1012.015 11L11 14H9c0 .768.293 1.536.879 2.121z"/></svg>
          </div>
          <h3 class="font-semibold text-slate-100">Adobe Firefly</h3>
          <p class="text-xs text-slate-500 mt-1">Firefly 3</p>
          <div class="mt-2 flex justify-center gap-1">
            <span class="text-xs px-2 py-0.5 bg-red-500/20 text-red-300 rounded">Adobe</span>
          </div>
        </div>

        <!-- Playground AI -->
        <div onclick="selectEngine('playground')" class="model-card bg-slate-800/40 border-2 border-slate-600/50 rounded-xl p-4 text-center" style="--model-color: #22D3EE; --model-shadow: rgba(34, 211, 238, 0.3); --model-bg: rgba(34, 211, 238, 0.1);">
          <div class="w-14 h-14 mx-auto mb-3 rounded-xl bg-gradient-to-br from-sky-400 to-blue-600 flex items-center justify-center shadow-lg">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
          </div>
          <h3 class="font-semibold text-slate-100">Playground</h3>
          <p class="text-xs text-slate-500 mt-1">Playground v2.5</p>
          <div class="mt-2 flex justify-center gap-1">
            <span class="text-xs px-2 py-0.5 bg-sky-500/20 text-sky-300 rounded">Gratis</span>
          </div>
        </div>

        <!-- Amazon Titan -->
        <div onclick="selectEngine('titan')" class="model-card bg-slate-800/40 border-2 border-slate-600/50 rounded-xl p-4 text-center" style="--model-color: #F97316; --model-shadow: rgba(249, 115, 22, 0.3); --model-bg: rgba(249, 115, 22, 0.1);">
          <div class="w-14 h-14 mx-auto mb-3 rounded-xl bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center shadow-lg">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/></svg>
          </div>
          <h3 class="font-semibold text-slate-100">Amazon Titan</h3>
          <p class="text-xs text-slate-500 mt-1">Titan Image</p>
          <div class="mt-2 flex justify-center gap-1">
            <span class="text-xs px-2 py-0.5 bg-orange-500/20 text-orange-300 rounded">AWS</span>
          </div>
        </div>

      </div>

      <!-- Engine Parameters -->
      <div id="engineParams" class="hidden">
        <div class="bg-slate-800/30 border border-slate-700/50 rounded-xl p-5">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-violet-500/20">
              <svg class="w-5 h-5 text-violet-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/></svg>
            </div>
            <h3 class="text-lg font-semibold text-slate-200">Parámetros de <span id="engineNameParam"></span></h3>
          </div>
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4" id="paramFields"></div>
        </div>
      </div>

      <!-- Engine Info -->
      <div id="engineInfo" class="mt-4 hidden">
        <div class="bg-slate-800/20 border border-slate-700/30 rounded-xl p-4">
          <div class="flex items-start gap-3">
            <svg class="w-5 h-5 text-slate-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            <div>
              <p class="text-sm text-slate-300" id="engineDescription"></p>
              <p class="text-xs text-slate-500 mt-2" id="engineTip"></p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab: Configuración -->
    <div id="content-configuracion" class="tab-content hidden">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="bg-gradient-to-r from-cyan-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-cyan-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-cyan-500/10"><svg class="w-5 h-5 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Tipo de representación</label>
          </div>
          <select id="tipoImagen" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-cyan-500/30 focus:outline-none">
            <option value="">Seleccionar tipo...</option>
            <option value="Render fotorrealista">Render fotorrealista</option>
            <option value="Visualización conceptual">Visualización conceptual</option>
            <option value="Axonometría">Axonometría</option>
            <option value="Vista isométrica">Vista isométrica</option>
            <option value="Corte arquitectónico">Corte arquitectónico</option>
            <option value="Planta arquitectónica amueblada">Planta arquitectónica amueblada</option>
            <option value="Planta esquemática">Planta esquemática</option>
            <option value="Diagrama volumétrico">Diagrama volumétrico</option>
            <option value="Render estilo maqueta">Render estilo maqueta</option>
            <option value="Collage arquitectónico">Collage arquitectónico</option>
            <option value="Sketch arquitectónico">Sketch arquitectónico</option>
            <option value="Blueprint técnico">Blueprint técnico</option>
          </select>
        </div>
        <div class="bg-gradient-to-r from-cyan-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-cyan-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-cyan-500/10"><svg class="w-5 h-5 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Tipo de vista</label>
          </div>
          <select id="tipoVista" onchange="updateSujetos()" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-cyan-500/30 focus:outline-none">
            <option value="">Seleccionar vista...</option>
            <option value="vivienda_interior">Vivienda Interior</option>
            <option value="vivienda_exterior">Vivienda Exterior</option>
            <option value="edificacion_interior">Edificación Interior</option>
            <option value="edificacion_exterior">Edificación Exterior</option>
          </select>
        </div>
        <div class="bg-gradient-to-r from-cyan-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-cyan-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-cyan-500/10"><svg class="w-5 h-5 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Sujeto</label>
          </div>
          <select id="sujeto" disabled class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-cyan-500/30 focus:outline-none disabled:opacity-50">
            <option value="">Primero selecciona tipo de vista</option>
          </select>
        </div>
        <div class="bg-gradient-to-r from-cyan-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-cyan-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-cyan-500/10"><svg class="w-5 h-5 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Materiales</label>
          </div>
          <textarea id="materiales" placeholder="Describe los materiales..." class="w-full min-h-[100px] bg-slate-900/50 border border-slate-600/50 text-slate-200 placeholder:text-slate-500 rounded-lg p-3 resize-none focus:ring-2 focus:ring-cyan-500/30 focus:outline-none"></textarea>
        </div>
      </div>
    </div>

    <!-- Tab: Escena -->
    <div id="content-escena" class="tab-content hidden">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <div class="bg-gradient-to-r from-emerald-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-emerald-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-emerald-500/10"><svg class="w-5 h-5 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Estilo arquitectónico</label>
          </div>
          <select id="estiloArquitectonico" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-emerald-500/30 focus:outline-none">
            <option value="">Seleccionar...</option>
            <option>escandinavo</option><option>brutalista</option><option>minimalista</option><option>mediterráneo</option><option>moderno</option><option>art déco</option><option>deconstructivista</option><option>postmodernista</option><option>industrial</option><option>futurista</option><option>contemporáneo</option><option>neoclásico</option><option>mid century</option><option>japandi</option>
          </select>
        </div>
        <div class="bg-gradient-to-r from-emerald-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-emerald-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-emerald-500/10"><svg class="w-5 h-5 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Tipo de plano</label>
          </div>
          <select id="tipoPlano" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-emerald-500/30 focus:outline-none">
            <option value="">Seleccionar...</option>
            <option>plano general</option><option>plano medio</option><option>primer plano</option><option>vista aérea</option><option>panorámica</option><option>extreme close-up</option>
          </select>
        </div>
        <div class="bg-gradient-to-r from-emerald-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-emerald-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-emerald-500/10"><svg class="w-5 h-5 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Ángulo</label>
          </div>
          <select id="angulo" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-emerald-500/30 focus:outline-none">
            <option value="">Seleccionar...</option>
            <option>frontal</option><option>aberrante</option><option>picado</option><option>contrapicado</option><option>lateral</option><option>cenital</option><option>nadir</option>
          </select>
        </div>
        <div class="bg-gradient-to-r from-emerald-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-emerald-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-emerald-500/10"><svg class="w-5 h-5 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Entorno</label>
          </div>
          <select id="entorno" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-emerald-500/30 focus:outline-none">
            <option value="">Seleccionar...</option>
            <option>urbano</option><option>suburbano</option><option>costero</option><option>desértico</option><option>forestal</option><option>montañoso</option><option>tropical</option><option>industrial</option><option>campus universitario</option><option>rural</option>
          </select>
        </div>
        <div class="bg-gradient-to-r from-emerald-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-emerald-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-emerald-500/10"><svg class="w-5 h-5 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Localización</label>
          </div>
          <select id="localizacion" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-emerald-500/30 focus:outline-none">
            <option value="">Seleccionar...</option>
            <option>pueblo costero</option><option>campo</option><option>ciudad densa</option><option>aldea rural</option><option>bosque</option><option>suburbano</option><option>junto al lago</option><option>junto al mar</option><option>parque</option><option>viñedo</option><option>isla</option><option>bahía marina</option><option>jardín</option><option>playa</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Tab: Ambiente -->
    <div id="content-ambiente" class="tab-content hidden">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <div class="bg-gradient-to-r from-amber-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-amber-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-amber-500/10"><svg class="w-5 h-5 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Iluminación</label>
          </div>
          <select id="iluminacion" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-amber-500/30 focus:outline-none">
            <option value="">Seleccionar...</option>
            <option>luz natural</option><option>amanecer</option><option>atardecer</option><option>noche con luces de neón</option><option>día nublado</option><option>interior con luz artificial</option><option>contraluz</option><option>luz difusa</option><option>iluminación dramática</option><option>poca iluminación</option><option>luz de luna</option><option>hora dorada</option><option>publicitaria de estudio</option>
          </select>
        </div>
        <div class="bg-gradient-to-r from-amber-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-amber-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-amber-500/10"><svg class="w-5 h-5 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Personas</label>
          </div>
          <select id="personas" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-amber-500/30 focus:outline-none">
            <option value="">Seleccionar...</option>
            <option>con gente paseando</option><option>con muchas personas</option><option>con ciclistas</option><option>con niños jugando</option><option>con 1 persona</option><option>con 2 personas</option><option>con algunas personas</option>
          </select>
        </div>
        <div class="bg-gradient-to-r from-amber-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-amber-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-amber-500/10"><svg class="w-5 h-5 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Clima</label>
          </div>
          <select id="clima" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-amber-500/30 focus:outline-none">
            <option value="">Seleccionar...</option>
            <option>verano soleado</option><option>otoño dorado</option><option>primavera lluviosa</option><option>clima árido</option><option>clima tropical</option><option>día ventoso</option><option>ambiente húmedo</option><option>tormenta eléctrica</option><option>niebla matinal</option><option>día nublado</option><option>invierno nevado</option>
          </select>
        </div>
        <div class="bg-gradient-to-r from-amber-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-amber-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-amber-500/10"><svg class="w-5 h-5 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Mobiliario</label>
          </div>
          <select id="mobiliario" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-amber-500/30 focus:outline-none">
            <option value="">Seleccionar...</option>
            <option>moderno</option><option>industrial</option><option>minimalista</option><option>clásico</option><option>bohemio</option><option>escandinavo</option><option>contemporáneo</option><option>rústico</option><option>art déco</option><option>ikea</option><option>mid-century</option>
          </select>
        </div>
        <div class="bg-gradient-to-r from-amber-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-amber-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-amber-500/10"><svg class="w-5 h-5 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Tráfico</label>
          </div>
          <select id="trafico" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-amber-500/30 focus:outline-none">
            <option value="">Seleccionar...</option>
            <option>con mucho tráfico</option><option>con poco tráfico</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Tab: Cámara -->
    <div id="content-camara" class="tab-content hidden">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="bg-gradient-to-r from-violet-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-violet-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-violet-500/10"><svg class="w-5 h-5 text-violet-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Tipo Fotografía</label>
          </div>
          <select id="tipoFotografia" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-violet-500/30 focus:outline-none">
            <option value="">Seleccionar...</option>
            <option>de interiores minimalista</option><option>arquitectura de lujo</option><option>de catalogo minimalista</option><option>de arquitectura brutalista</option><option>arquitectónica con luz natural</option><option>cinematográfica de arquitectura</option><option>de revista de interiores</option><option>arquitectónica contemporánea</option><option>blanco y negro alto contraste</option><option>publicitaria</option>
          </select>
        </div>
        <div class="bg-gradient-to-r from-violet-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-violet-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-violet-500/10"><svg class="w-5 h-5 text-violet-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Balance de blancos</label>
          </div>
          <select id="balanceBlancos" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-violet-500/30 focus:outline-none">
            <option value="">Seleccionar...</option>
            <option>tonos calidos</option><option>tonos fríos</option><option>tonos neutros</option>
          </select>
        </div>
        <div class="bg-gradient-to-r from-violet-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-violet-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-violet-500/10"><svg class="w-5 h-5 text-violet-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Cámara</label>
          </div>
          <select id="camara" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-violet-500/30 focus:outline-none">
            <option value="">Seleccionar...</option>
            <option>Canon EOS 5D Mark IV</option><option>Canon EOS R5</option><option>Nikon D850</option><option>Panasonic Lumix S1R</option><option>Leica SL2</option><option>Hasselblad X1D II 50C</option><option>Hasselblad H6D-100c</option><option>Phase One XF IQ4</option><option>Nikon Z7 II</option><option>Fujifilm GFX 100</option>
          </select>
        </div>
        <div class="bg-gradient-to-r from-violet-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-violet-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-violet-500/10"><svg class="w-5 h-5 text-violet-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Composición fotográfica</label>
          </div>
          <select id="composicion" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-violet-500/30 focus:outline-none">
            <option value="">Seleccionar...</option>
            <option>Simetría axial</option><option>Sección/Espiral áurea</option><option>Regla de los tercios</option><option>Radial</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Tab: Avanzado -->
    <div id="content-avanzado" class="tab-content hidden">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
        <div class="bg-gradient-to-r from-rose-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-rose-500 rounded-xl p-5 transition-all card-hover">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-lg bg-rose-500/10"><svg class="w-5 h-5 text-rose-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/></svg></div>
            <label class="text-base font-semibold text-slate-200">Negative prompts</label>
          </div>
          <div class="grid grid-cols-2 gap-2 max-h-64 overflow-y-auto pr-2 custom-scrollbar" id="negativeCheckboxes"></div>
        </div>
        <div class="space-y-4">
          <!-- Sin texto en imagen - NUEVO -->
          <div class="bg-gradient-to-r from-blue-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-blue-500 rounded-xl p-5 transition-all card-hover">
            <div class="flex items-center gap-3 mb-4">
              <div class="p-2 rounded-lg bg-blue-500/10">
                <svg class="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"/></svg>
              </div>
              <label class="text-base font-semibold text-slate-200">Control de texto</label>
            </div>
            <div class="space-y-3">
              <label class="flex items-center gap-3 p-3 rounded-lg bg-slate-900/30 hover:bg-slate-900/50 cursor-pointer transition-colors">
                <input type="checkbox" id="sinTexto" class="w-5 h-5 rounded border-slate-500 bg-slate-900/50 text-blue-500 focus:ring-blue-500/30">
                <div>
                  <span class="text-slate-200 font-medium">Sin texto en la imagen</span>
                  <p class="text-xs text-slate-500">Evita que aparezca texto, letras o palabras en la imagen generada</p>
                </div>
              </label>
              <label class="flex items-center gap-3 p-3 rounded-lg bg-slate-900/30 hover:bg-slate-900/50 cursor-pointer transition-colors">
                <input type="checkbox" id="sinWatermark" class="w-5 h-5 rounded border-slate-500 bg-slate-900/50 text-blue-500 focus:ring-blue-500/30">
                <div>
                  <span class="text-slate-200 font-medium">Sin marcas de agua</span>
                  <p class="text-xs text-slate-500">Evita logos, firmas o marcas de agua</p>
                </div>
              </label>
            </div>
          </div>
          <div class="bg-gradient-to-r from-rose-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-rose-500 rounded-xl p-5 transition-all card-hover">
            <div class="flex items-center gap-3 mb-4">
              <div class="p-2 rounded-lg bg-rose-500/10"><svg class="w-5 h-5 text-rose-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></div>
              <label class="text-base font-semibold text-slate-200">Negativo adicional</label>
            </div>
            <textarea id="negativoAdicional" placeholder="Añade prompts negativos adicionales..." class="w-full min-h-[80px] bg-slate-900/50 border border-slate-600/50 text-slate-200 placeholder:text-slate-500 rounded-lg p-3 resize-none focus:ring-2 focus:ring-rose-500/30 focus:outline-none"></textarea>
          </div>
          <div class="bg-gradient-to-r from-rose-500/20 to-transparent bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 border-l-4 border-l-rose-500 rounded-xl p-5 transition-all card-hover">
            <div class="flex items-center gap-3 mb-4">
              <div class="p-2 rounded-lg bg-rose-500/10"><svg class="w-5 h-5 text-rose-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/></svg></div>
              <label class="text-base font-semibold text-slate-200">Notas adicionales</label>
            </div>
            <textarea id="notasAdicionales" placeholder="Añade notas adicionales al prompt..." class="w-full min-h-[80px] bg-slate-900/50 border border-slate-600/50 text-slate-200 placeholder:text-slate-500 rounded-lg p-3 resize-none focus:ring-2 focus:ring-rose-500/30 focus:outline-none"></textarea>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab: Ideas - NUEVA PESTAÑA -->
    <div id="content-ideas" class="tab-content hidden">
      <div class="max-w-2xl mx-auto">
        <div class="text-center mb-6">
          <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-amber-500 to-orange-600 flex items-center justify-center shadow-lg">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/></svg>
          </div>
          <h2 class="text-xl font-semibold text-slate-200">Sugiere una mejora</h2>
          <p class="text-slate-400 text-sm mt-2">¿Echas de menos algún campo o opción? ¡Cuéntanoslo!</p>
        </div>
        
        <div class="bg-gradient-to-r from-amber-500/10 to-orange-500/5 bg-slate-800/40 backdrop-blur-sm border border-amber-500/30 rounded-xl p-6">
          <form id="ideasForm">
            <div class="space-y-4">
              <!-- Nombre -->
              <div>
                <label class="block text-sm font-medium text-slate-300 mb-2">Tu nombre (opcional)</label>
                <input type="text" id="ideaNombre" placeholder="¿Cómo te llamas?" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-3 focus:ring-2 focus:ring-amber-500/30 focus:outline-none placeholder:text-slate-500">
              </div>
              
              <!-- Email -->
              <div>
                <label class="block text-sm font-medium text-slate-300 mb-2">Tu email (opcional)</label>
                <input type="email" id="ideaEmail" placeholder="Para responderte si es necesario" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-3 focus:ring-2 focus:ring-amber-500/30 focus:outline-none placeholder:text-slate-500">
              </div>
              
              <!-- Sección -->
              <div>
                <label class="block text-sm font-medium text-slate-300 mb-2">¿En qué sección?</label>
                <select id="ideaSeccion" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-3 focus:ring-2 focus:ring-amber-500/30 focus:outline-none">
                  <option value="">Selecciona una sección...</option>
                  <option value="Motor IA">Motor IA (añadir nuevo modelo, parámetros...)</option>
                  <option value="Configuración">Configuración (tipo de imagen, vista, sujeto, materiales)</option>
                  <option value="Escena">Escena (estilo arquitectónico, tipo de plano, ángulo, entorno, localización)</option>
                  <option value="Ambiente">Ambiente (iluminación, personas, clima, mobiliario, tráfico)</option>
                  <option value="Cámara">Cámara (tipo fotografía, balance de blancos, cámara, composición)</option>
                  <option value="Avanzado">Avanzado (negative prompts, control de texto, notas)</option>
                  <option value="Interface">Interfaz (diseño, usabilidad, nuevas pestañas)</option>
                  <option value="Formato">Formato de prompt (adaptación a modelos específicos)</option>
                  <option value="Otro">Otro / Mejora general</option>
                </select>
              </div>
              
              <!-- Sugerencia -->
              <div>
                <label class="block text-sm font-medium text-slate-300 mb-2">Tu sugerencia *</label>
                <textarea id="ideaTexto" required placeholder="Describe qué campo, opción o mejora te gustaría ver. Por ejemplo: 'Me gustaría poder seleccionar la hora del día' o 'Añadir opción de estilo cyberpunk en estilos arquitectónicos'" class="w-full min-h-[120px] bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-3 focus:ring-2 focus:ring-amber-500/30 focus:outline-none placeholder:text-slate-500 resize-none"></textarea>
              </div>
              
              <!-- Submit -->
              <button type="submit" class="w-full bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white font-semibold py-3 rounded-xl transition-all duration-300 hover:scale-[1.02] active:scale-[0.98] flex items-center justify-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
                Enviar sugerencia
              </button>
            </div>
          </form>
          
          <!-- Success message -->
          <div id="ideaSuccess" class="hidden mt-4 p-4 bg-emerald-500/20 border border-emerald-500/30 rounded-xl text-center">
            <svg class="w-8 h-8 text-emerald-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            <p class="text-emerald-300 font-medium">¡Gracias por tu sugerencia!</p>
            <p class="text-emerald-400/70 text-sm mb-4">La revisaremos lo antes posible</p>
            <button onclick="resetIdeaForm()" class="bg-emerald-500/30 hover:bg-emerald-500/50 text-emerald-300 px-4 py-2 rounded-lg transition-colors text-sm font-medium">
              Enviar otra sugerencia
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab: Plantillas -->
    <div id="content-plantillas" class="tab-content hidden">
      <div class="mb-6 text-center">
        <h2 class="text-xl font-semibold text-slate-200 mb-2">Plantillas de Efectos</h2>
        <p class="text-slate-400 text-sm">Selecciona una plantilla para aplicar configuraciones predefinidas</p>
      </div>

      <!-- Category Filter -->
      <div class="flex flex-wrap justify-center gap-2 mb-6">
        <button onclick="filterTemplates('all')" class="template-filter-btn active px-3 py-1.5 rounded-lg bg-pink-500/20 text-pink-300 border border-pink-500/30 text-sm transition-all" data-filter="all">Todas</button>
        <button onclick="filterTemplates('atmosphere')" class="template-filter-btn px-3 py-1.5 rounded-lg bg-slate-700/30 text-slate-400 border border-slate-600/30 text-sm transition-all hover:bg-slate-700/50" data-filter="atmosphere">Atmósfera</button>
        <button onclick="filterTemplates('timeofday')" class="template-filter-btn px-3 py-1.5 rounded-lg bg-slate-700/30 text-slate-400 border border-slate-600/30 text-sm transition-all hover:bg-slate-700/50" data-filter="timeofday">Momento del día</button>
        <button onclick="filterTemplates('style')" class="template-filter-btn px-3 py-1.5 rounded-lg bg-slate-700/30 text-slate-400 border border-slate-600/30 text-sm transition-all hover:bg-slate-700/50" data-filter="style">Estilo</button>
      </div>

      <!-- Templates Grid -->
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" id="templatesGrid">
        
        <!-- Golden Hour -->
        <div onclick="applyTemplate('golden-hour')" class="template-card group cursor-pointer bg-slate-800/40 border-2 border-slate-600/50 rounded-xl overflow-hidden transition-all duration-300 hover:border-amber-500/50 hover:shadow-lg hover:shadow-amber-500/10" data-category="atmosphere timeofday">
          <div class="aspect-square relative overflow-hidden">
            <img src="assets/template_1.jpeg" class="absolute inset-0 w-full h-full object-cover" alt="golden-hour">
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900/80 via-transparent to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3">
              <h3 class="font-semibold text-white text-sm">🌅 Golden Hour</h3>
              <p class="text-xs text-amber-200/80">Luz dorada atardecer</p>
            </div>
          </div>
          <div class="p-3 bg-slate-800/60">
            <p class="text-xs text-slate-400 line-clamp-2">Sombras largas, ambiente cálido, luz cinematográfica</p>
          </div>
        </div>

        <!-- Blue Hour -->
        <div onclick="applyTemplate('blue-hour')" class="template-card group cursor-pointer bg-slate-800/40 border-2 border-slate-600/50 rounded-xl overflow-hidden transition-all duration-300 hover:border-blue-500/50 hover:shadow-lg hover:shadow-blue-500/10" data-category="atmosphere timeofday">
          <div class="aspect-square relative overflow-hidden">
            <img src="assets/template_2.jpeg" class="absolute inset-0 w-full h-full object-cover" alt="blue-hour">
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900/80 via-transparent to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3">
              <h3 class="font-semibold text-white text-sm">🌙 Blue Hour</h3>
              <p class="text-xs text-blue-200/80">Luz azul crepuscular</p>
            </div>
          </div>
          <div class="p-3 bg-slate-800/60">
            <p class="text-xs text-slate-400 line-clamp-2">Ambiente tranquilo, luces ciudad encendidas</p>
          </div>
        </div>

        <!-- Rain Dramatic -->
        <div onclick="applyTemplate('rain-dramatic')" class="template-card group cursor-pointer bg-slate-800/40 border-2 border-slate-600/50 rounded-xl overflow-hidden transition-all duration-300 hover:border-slate-400/50 hover:shadow-lg hover:shadow-slate-500/10" data-category="atmosphere">
          <div class="aspect-square relative overflow-hidden">
            <img src="assets/template_3.jpeg" class="absolute inset-0 w-full h-full object-cover" alt="rain-dramatic">
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900/80 via-transparent to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3">
              <h3 class="font-semibold text-white text-sm">🌧️ Lluvia dramática</h3>
              <p class="text-xs text-slate-300/80">Superficies mojadas</p>
            </div>
          </div>
          <div class="p-3 bg-slate-800/60">
            <p class="text-xs text-slate-400 line-clamp-2">Reflejos, ambiente melancólico, charcos</p>
          </div>
        </div>

        <!-- Fog Atmospheric -->
        <div onclick="applyTemplate('fog-atmospheric')" class="template-card group cursor-pointer bg-slate-800/40 border-2 border-slate-600/50 rounded-xl overflow-hidden transition-all duration-300 hover:border-gray-400/50 hover:shadow-lg hover:shadow-gray-500/10" data-category="atmosphere">
          <div class="aspect-square relative overflow-hidden">
            <img src="assets/template_4.jpeg" class="absolute inset-0 w-full h-full object-cover" alt="fog-atmospheric">
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900/80 via-transparent to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3">
              <h3 class="font-semibold text-white text-sm">🌫️ Niebla atmosférica</h3>
              <p class="text-xs text-gray-200/80">Profundidad y misterio</p>
            </div>
          </div>
          <div class="p-3 bg-slate-800/60">
            <p class="text-xs text-slate-400 line-clamp-2">Luz difusa, suavizado, atmósfera etérea</p>
          </div>
        </div>

        <!-- Winter Snow -->
        <div onclick="applyTemplate('winter-snow')" class="template-card group cursor-pointer bg-slate-800/40 border-2 border-slate-600/50 rounded-xl overflow-hidden transition-all duration-300 hover:border-cyan-300/50 hover:shadow-lg hover:shadow-cyan-400/10" data-category="atmosphere">
          <div class="aspect-square relative overflow-hidden">
            <img src="assets/template_5.jpeg" class="absolute inset-0 w-full h-full object-cover" alt="winter-snow">
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900/80 via-transparent to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3">
              <h3 class="font-semibold text-slate-800 text-sm">❄️ Invierno nevado</h3>
              <p class="text-xs text-cyan-700/80">Paisaje invernal</p>
            </div>
          </div>
          <div class="p-3 bg-slate-800/60">
            <p class="text-xs text-slate-400 line-clamp-2">Nieve, frío, ambiente sereno, luz suave</p>
          </div>
        </div>

        <!-- Night Neon -->
        <div onclick="applyTemplate('night-neon')" class="template-card group cursor-pointer bg-slate-800/40 border-2 border-slate-600/50 rounded-xl overflow-hidden transition-all duration-300 hover:border-pink-500/50 hover:shadow-lg hover:shadow-pink-500/10" data-category="atmosphere timeofday style">
          <div class="aspect-square relative overflow-hidden">
            <img src="assets/template_6.jpeg" class="absolute inset-0 w-full h-full object-cover" alt="night-neon">
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900/80 via-transparent to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3">
              <h3 class="font-semibold text-white text-sm">🌃 Noche urbana</h3>
              <p class="text-xs text-pink-200/80">Luces neón</p>
            </div>
          </div>
          <div class="p-3 bg-slate-800/60">
            <p class="text-xs text-slate-400 line-clamp-2">Cyberpunk, contrastes fuertes, luces vibrantes</p>
          </div>
        </div>

        <!-- Cinematic -->
        <div onclick="applyTemplate('cinematic')" class="template-card group cursor-pointer bg-slate-800/40 border-2 border-slate-600/50 rounded-xl overflow-hidden transition-all duration-300 hover:border-amber-400/50 hover:shadow-lg hover:shadow-amber-400/10" data-category="style">
          <div class="aspect-square relative overflow-hidden">
            <img src="assets/template_7.jpeg" class="absolute inset-0 w-full h-full object-cover" alt="cinematic">
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900/80 via-transparent to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3">
              <h3 class="font-semibold text-white text-sm">🎬 Cinematográfico</h3>
              <p class="text-xs text-amber-200/80">Estilo película</p>
            </div>
          </div>
          <div class="p-3 bg-slate-800/60">
            <p class="text-xs text-slate-400 line-clamp-2">Anamórfico, lens flare, color grading</p>
          </div>
        </div>

        <!-- Minimalist Clean -->
        <div onclick="applyTemplate('minimalist-clean')" class="template-card group cursor-pointer bg-slate-800/40 border-2 border-slate-600/50 rounded-xl overflow-hidden transition-all duration-300 hover:border-gray-300/50 hover:shadow-lg hover:shadow-gray-300/10" data-category="style">
          <div class="aspect-square relative overflow-hidden">
            <img src="assets/template_8.jpeg" class="absolute inset-0 w-full h-full object-cover" alt="minimalist-clean">
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900/80 via-transparent to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3">
              <h3 class="font-semibold text-slate-700 text-sm">⬜ Minimalista limpio</h3>
              <p class="text-xs text-gray-500/80">Composición simple</p>
            </div>
          </div>
          <div class="p-3 bg-slate-800/60">
            <p class="text-xs text-slate-400 line-clamp-2">Colores neutros, geometría pura, formas simples</p>
          </div>
        </div>

        <!-- Editorial Premium -->
        <div onclick="applyTemplate('editorial-premium')" class="template-card group cursor-pointer bg-slate-800/40 border-2 border-slate-600/50 rounded-xl overflow-hidden transition-all duration-300 hover:border-amber-300/50 hover:shadow-lg hover:shadow-amber-300/10" data-category="style">
          <div class="aspect-square relative overflow-hidden">
            <img src="assets/template_9.jpeg" class="absolute inset-0 w-full h-full object-cover" alt="editorial-premium">
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900/80 via-transparent to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3">
              <h3 class="font-semibold text-slate-700 text-sm">✨ Editorial premium</h3>
              <p class="text-xs text-amber-600/80">Estilo revista</p>
            </div>
          </div>
          <div class="p-3 bg-slate-800/60">
            <p class="text-xs text-slate-400 line-clamp-2">Alta gama, luces estudio, acabado lujoso</p>
          </div>
        </div>

        <!-- Sunrise -->
        <div onclick="applyTemplate('sunrise')" class="template-card group cursor-pointer bg-slate-800/40 border-2 border-slate-600/50 rounded-xl overflow-hidden transition-all duration-300 hover:border-pink-400/50 hover:shadow-lg hover:shadow-pink-400/10" data-category="timeofday">
          <div class="aspect-square relative overflow-hidden">
            <img src="assets/template_10.jpeg" class="absolute inset-0 w-full h-full object-cover" alt="sunrise">
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900/80 via-transparent to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3">
              <h3 class="font-semibold text-slate-700 text-sm">🌅 Amanecer</h3>
              <p class="text-xs text-pink-500/80">Luz rosada</p>
            </div>
          </div>
          <div class="p-3 bg-slate-800/60">
            <p class="text-xs text-slate-400 line-clamp-2">Ambiente fresco, luz temprana, esperanza</p>
          </div>
        </div>

        <!-- Midday Bright -->
        <div onclick="applyTemplate('midday-bright')" class="template-card group cursor-pointer bg-slate-800/40 border-2 border-slate-600/50 rounded-xl overflow-hidden transition-all duration-300 hover:border-yellow-400/50 hover:shadow-lg hover:shadow-yellow-400/10" data-category="timeofday">
          <div class="aspect-square relative overflow-hidden">
            <img src="assets/template_11.jpeg" class="absolute inset-0 w-full h-full object-cover" alt="midday-bright">
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900/80 via-transparent to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3">
              <h3 class="font-semibold text-slate-700 text-sm">☀️ Mediodía</h3>
              <p class="text-xs text-yellow-600/80">Luz directa</p>
            </div>
          </div>
          <div class="p-3 bg-slate-800/60">
            <p class="text-xs text-slate-400 line-clamp-2">Sombras marcadas, cielo azul, alto contraste</p>
          </div>
        </div>

        <!-- Sketch Artistic -->
        <div onclick="applyTemplate('sketch-artistic')" class="template-card group cursor-pointer bg-slate-800/40 border-2 border-slate-600/50 rounded-xl overflow-hidden transition-all duration-300 hover:border-stone-400/50 hover:shadow-lg hover:shadow-stone-400/10" data-category="style">
          <div class="aspect-square relative overflow-hidden">
            <img src="assets/template_12.jpeg" class="absolute inset-0 w-full h-full object-cover" alt="sketch-artistic">
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900/80 via-transparent to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3">
              <h3 class="font-semibold text-slate-700 text-sm">✏️ Sketch artístico</h3>
              <p class="text-xs text-stone-500/80">Estilo dibujo</p>
            </div>
          </div>
          <div class="p-3 bg-slate-800/60">
            <p class="text-xs text-slate-400 line-clamp-2">Líneas a mano, textura lápiz, conceptual</p>
          </div>
        </div>

        <!-- Ethereal Dreamy -->
        <div onclick="applyTemplate('ethereal-dreamy')" class="template-card group cursor-pointer bg-slate-800/40 border-2 border-slate-600/50 rounded-xl overflow-hidden transition-all duration-300 hover:border-violet-400/50 hover:shadow-lg hover:shadow-violet-400/10" data-category="atmosphere style">
          <div class="aspect-square relative overflow-hidden">
            <img src="assets/template_13.jpeg" class="absolute inset-0 w-full h-full object-cover" alt="ethereal-dreamy">
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900/80 via-transparent to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3">
              <h3 class="font-semibold text-slate-700 text-sm">✨ Onírico/Etérico</h3>
              <p class="text-xs text-violet-500/80">Ambiente soñador</p>
            </div>
          </div>
          <div class="p-3 bg-slate-800/60">
            <p class="text-xs text-slate-400 line-clamp-2">Brillos suaves, light leaks, colores pastel</p>
          </div>
        </div>

      </div>

      <!-- Applied Template Notice -->
      <div id="templateApplied" class="hidden mt-4">
        <div class="bg-pink-500/20 border border-pink-500/30 rounded-xl p-4 flex items-center gap-3">
          <svg class="w-5 h-5 text-pink-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
          <span class="text-pink-200" id="templateAppliedText">Plantilla aplicada correctamente</span>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="flex justify-center gap-4 mt-8 mb-6">
      <button onclick="generatePrompts()" class="bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600 text-white shadow-lg shadow-emerald-500/25 px-8 py-4 text-lg font-semibold rounded-2xl transition-all duration-300 hover:scale-105 hover:shadow-xl hover:shadow-emerald-500/30 active:scale-95 flex items-center gap-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/></svg>
        Generar
      </button>
      <button onclick="clearAll()" class="border border-slate-600 hover:bg-slate-800 text-slate-300 hover:text-white px-8 py-4 text-lg font-semibold rounded-2xl transition-all duration-300 hover:scale-105 active:scale-95 flex items-center gap-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>
        Limpiar
      </button>
    </div>

    <!-- Output Section -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
      <div class="bg-gradient-to-r from-emerald-500/10 to-green-500/5 bg-slate-800/40 backdrop-blur-sm border border-emerald-500/30 border-l-4 border-l-emerald-500 rounded-xl p-5 transition-all card-hover">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center gap-3">
            <div class="p-2 rounded-lg bg-emerald-500/20"><svg class="w-5 h-5 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/></svg></div>
            <label class="text-base font-semibold text-emerald-400">Prompt Positivo</label>
          </div>
          <button onclick="copyText('promptPositivo')" id="copyPosBtn" class="border border-emerald-500/50 hover:bg-emerald-500/20 text-emerald-400 hover:text-emerald-300 px-3 py-1.5 rounded-lg text-sm transition-all flex items-center gap-1">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
            Copiar
          </button>
        </div>
        <textarea id="promptPositivo" readonly placeholder="El prompt positivo aparecerá aquí..." class="w-full min-h-[200px] bg-slate-900/50 border border-slate-600/50 text-slate-200 placeholder:text-slate-500 rounded-lg p-3 resize-none focus:outline-none"></textarea>
      </div>
      <div class="bg-gradient-to-r from-rose-500/10 to-red-500/5 bg-slate-800/40 backdrop-blur-sm border border-rose-500/30 border-l-4 border-l-rose-500 rounded-xl p-5 transition-all card-hover">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center gap-3">
            <div class="p-2 rounded-lg bg-rose-500/20"><svg class="w-5 h-5 text-rose-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></div>
            <label class="text-base font-semibold text-rose-400">Prompt Negativo</label>
          </div>
          <button onclick="copyText('promptNegativo')" id="copyNegBtn" class="border border-rose-500/50 hover:bg-rose-500/20 text-rose-400 hover:text-rose-300 px-3 py-1.5 rounded-lg text-sm transition-all flex items-center gap-1">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
            Copiar
          </button>
        </div>
        <textarea id="promptNegativo" readonly placeholder="El prompt negativo aparecerá aquí..." class="w-full min-h-[200px] bg-slate-900/50 border border-slate-600/50 text-slate-200 placeholder:text-slate-500 rounded-lg p-3 resize-none focus:outline-none"></textarea>
      </div>
    </div>
  </main>

  <script>
    // State
    let selectedEngine = null;

    // Engine configurations
    const engineConfigs = {
      midjourney: {
        name: 'Midjourney',
        description: 'Motor de IA premium conocido por su estilo artístico y calidad visual excepcional. Ideal para visualizaciones arquitectónicas con estilo cinematográfico.',
        tip: 'Usa --ar para aspect ratio, --v para versión, --s para stylize (0-1000), --q para calidad.',
        params: [
          { id: 'aspectRatio', label: 'Aspect Ratio', options: ['--ar 16:9', '--ar 1:1', '--ar 9:16', '--ar 3:2', '--ar 2:3', '--ar 4:3', '--ar 3:4', '--ar 21:9'] },
          { id: 'version', label: 'Versión', options: ['--v 6.1', '--v 6', '--v 5.2', '--niji 6', '--niji 5'] },
          { id: 'style', label: 'Stylize', options: ['--s 50', '--s 100', '--s 250', '--s 500', '--s 750'] },
          { id: 'quality', label: 'Calidad', options: ['--q 0.25', '--q 0.5', '--q 1'] },
          { id: 'weird', label: 'Weird', options: ['--w 0', '--w 100', '--w 250', '--w 500'] }
        ],
        formatPrompt: (prompt, params) => prompt + ' ' + params.join(' '),
        formatNegative: (neg) => '--no ' + neg.replace(/, /g, ', ')
      },
      stable_diffusion: {
        name: 'Stable Diffusion',
        description: 'Motor open source muy versátil. Excelente para control preciso con ControlNet y gran variedad de modelos personalizados.',
        tip: 'Usa pesos (texto:1.2) para énfasis. Negative prompt muy importante para calidad.',
        params: [
          { id: 'resolution', label: 'Resolución', options: ['1024x1024', '1152x896', '896x1152', '1216x832', '832x1216', '1344x768', '768x1344', '1536x640'] },
          { id: 'steps', label: 'Steps', options: ['20 steps', '30 steps', '40 steps', '50 steps'] },
          { id: 'cfg', label: 'CFG Scale', options: ['CFG 5', 'CFG 7', 'CFG 9', 'CFG 12'] },
          { id: 'sampler', label: 'Sampler', options: ['DPM++ 2M', 'DPM++ SDE', 'Euler a', 'DDIM', 'UniPC'] }
        ],
        formatPrompt: (prompt, params) => `(${prompt}), ${params.join(', ')}`,
        formatNegative: (neg) => `(${neg}), low quality, worst quality, blurry`
      },
      dalle: {
        name: 'DALL-E',
        description: 'Motor de OpenAI con excelente comprensión de prompts en lenguaje natural. Ideal para imágenes fotorrealistas y creativas.',
        tip: 'DALL-E 3 no soporta negative prompts. Los prompts deben ser descriptivos y en lenguaje natural.',
        params: [
          { id: 'size', label: 'Tamaño', options: ['1024x1024', '1792x1024', '1024x1792'] },
          { id: 'quality', label: 'Calidad', options: ['standard', 'hd'] },
          { id: 'style', label: 'Estilo', options: ['vivid', 'natural'] }
        ],
        formatPrompt: (prompt, params) => prompt.replace(/:/g, ' -'),
        formatNegative: (neg) => null
      },
      leonardo: {
        name: 'Leonardo AI',
        description: 'Plataforma completa con modelos propios y de terceros. Excelente para imágenes artísticas y consistentes.',
        tip: 'Phoenix es el modelo más reciente. Usa Guidance para controlar fidelidad al prompt.',
        params: [
          { id: 'model', label: 'Modelo', options: ['Leonardo Phoenix', 'Leonardo Diffusion XL', 'SDXL 1.0', 'Leonardo Kino XL', 'PhotoReal'] },
          { id: 'aspectRatio', label: 'Aspect Ratio', options: ['1:1', '16:9', '9:16', '3:2', '2:3', '4:5', '5:4'] },
          { id: 'guidance', label: 'Guidance', options: ['3', '5', '7', '10', '15'] },
          { id: 'steps', label: 'Steps', options: ['20', '30', '40', '50'] }
        ],
        formatPrompt: (prompt, params) => prompt + ', ' + params.filter(p => !p.includes('model')).join(', '),
        formatNegative: (neg) => neg
      },
      flux: {
        name: 'Flux',
        description: 'Motor de Black Forest Labs con calidad excepcional. Flux.1 Pro ofrece resultados de nivel profesional.',
        tip: 'Excelente para texto en imágenes y comprensión de prompts complejos.',
        params: [
          { id: 'model', label: 'Modelo', options: ['Flux.1 Pro', 'Flux.1 Dev', 'Flux.1 Schnell'] },
          { id: 'aspectRatio', label: 'Aspect Ratio', options: ['1:1', '16:9', '9:16', '3:2', '2:3', '4:3', '3:4'] },
          { id: 'steps', label: 'Steps', options: ['20', '28', '40', '50'] },
          { id: 'guidance', label: 'Guidance', options: ['2.5', '3.5', '5', '7'] }
        ],
        formatPrompt: (prompt, params) => prompt + ', ' + params.join(', '),
        formatNegative: (neg) => neg
      },
      ideogram: {
        name: 'Ideogram',
        description: 'Especializado en generación de texto dentro de imágenes. Ideal para logos, carteles y diseños con tipografía.',
        tip: 'Usa comillas para texto específico. Excelente para renders con rótulos.',
        params: [
          { id: 'model', label: 'Modelo', options: ['Ideogram 2.0', 'Ideogram 1.0', 'Ideogram V2 Turbo'] },
          { id: 'aspectRatio', label: 'Aspect Ratio', options: ['1:1', '16:9', '9:16', '3:2', '2:3', '4:3'] },
          { id: 'style', label: 'Estilo', options: ['Auto', 'General', 'Realistic', 'Design', '3D'] },
          { id: 'magicPrompt', label: 'Magic Prompt', options: ['On', 'Off'] }
        ],
        formatPrompt: (prompt, params) => prompt + ', ' + params.join(', '),
        formatNegative: (neg) => neg
      },
      nano_banana: {
        name: 'Nano Banana',
        description: 'Motor rápido de Fal.ai optimizado para generación de alta velocidad. Ideal para prototipos y pruebas rápidas.',
        tip: 'Muy rápido y económico. Perfecto para iterar rápidamente.',
        params: [
          { id: 'model', label: 'Modelo', options: ['Nano Banana v2', 'Nano Banana v1'] },
          { id: 'aspectRatio', label: 'Aspect Ratio', options: ['1:1', '16:9', '9:16', '3:2', '2:3'] },
          { id: 'steps', label: 'Steps', options: ['4', '8', '12', '20'] },
          { id: 'guidance', label: 'Guidance', options: ['2', '3.5', '5', '7'] }
        ],
        formatPrompt: (prompt, params) => prompt + ', ' + params.join(', '),
        formatNegative: (neg) => neg
      },
      recraft: {
        name: 'Recraft AI',
        description: 'Especializado en diseño gráfico y vectores. Único en generar SVGs y arte vectorial de alta calidad.',
        tip: 'Ideal para logos, iconos e ilustraciones vectoriales arquitectónicas.',
        params: [
          { id: 'type', label: 'Tipo', options: ['Raster Image', 'Vector Image'] },
          { id: 'style', label: 'Estilo', options: ['Realistic Image', 'Digital Illustration', 'Vector Art', 'Icon'] },
          { id: 'aspectRatio', label: 'Aspect Ratio', options: ['1:1', '16:9', '9:16', '4:3', '3:4'] },
          { id: 'quality', label: 'Calidad', options: ['Standard', 'High', 'Ultra'] }
        ],
        formatPrompt: (prompt, params) => prompt + ', ' + params.join(', '),
        formatNegative: (neg) => neg
      },
      runway: {
        name: 'Runway',
        description: 'Líder en generación de video e imagen. Gen-3 ofrece calidad cinematográfica para visualizaciones.',
        tip: 'Ideal para animar renders arquitectónicos. Soporta texto a video.',
        params: [
          { id: 'model', label: 'Modelo', options: ['Gen-3 Alpha', 'Gen-2', 'Gen-1'] },
          { id: 'aspectRatio', label: 'Aspect Ratio', options: ['16:9', '9:16', '1:1', '4:3', '3:4'] },
          { id: 'motion', label: 'Movimiento', options: ['Static', 'Low', 'Medium', 'High'] },
          { id: 'steps', label: 'Steps', options: ['20', '30', '40', '50'] }
        ],
        formatPrompt: (prompt, params) => prompt + ', ' + params.join(', '),
        formatNegative: (neg) => neg
      },
      firefly: {
        name: 'Adobe Firefly',
        description: 'Motor de Adobe integrado con Creative Cloud. Ideal para flujos de trabajo profesionales de diseño.',
        tip: 'Perfecto para integrar con Photoshop e Illustrator. Estilo comercial.',
        params: [
          { id: 'model', label: 'Modelo', options: ['Firefly 3', 'Firefly 2'] },
          { id: 'aspectRatio', label: 'Aspect Ratio', options: ['1:1', '16:9', '9:16', '4:3', '3:4', '3:2', '2:3'] },
          { id: 'style', label: 'Estilo', options: ['Auto', 'Photo', 'Art', 'Graphic Design'] },
          { id: 'quality', label: 'Calidad', options: ['Standard', 'High'] }
        ],
        formatPrompt: (prompt, params) => prompt + ', ' + params.join(', '),
        formatNegative: (neg) => neg
      },
      playground: {
        name: 'Playground',
        description: 'Plataforma gratuita con modelos propios. Excelente relación calidad-gratuidad.',
        tip: 'Playground v2.5 es el mejor modelo. Ofrece crédito gratuito diario.',
        params: [
          { id: 'model', label: 'Modelo', options: ['Playground v2.5', 'Playground v2', 'SDXL'] },
          { id: 'aspectRatio', label: 'Aspect Ratio', options: ['1:1', '16:9', '9:16', '3:2', '2:3', '4:5', '5:4'] },
          { id: 'guidance', label: 'Guidance', options: ['3', '5', '7', '10'] },
          { id: 'steps', label: 'Steps', options: ['25', '30', '40', '50'] }
        ],
        formatPrompt: (prompt, params) => prompt + ', ' + params.join(', '),
        formatNegative: (neg) => neg
      },
      titan: {
        name: 'Amazon Titan',
        description: 'Modelo de AWS Bedrock. Integración nativa con servicios Amazon. Ideal para aplicaciones enterprise.',
        tip: 'Buen rendimiento para aplicaciones empresariales escalables.',
        params: [
          { id: 'model', label: 'Modelo', options: ['Titan Image Generator v2', 'Titan Image Generator v1'] },
          { id: 'aspectRatio', label: 'Aspect Ratio', options: ['1:1', '16:9', '9:16', '3:2', '2:3'] },
          { id: 'quality', label: 'Calidad', options: ['Standard', 'Premium'] },
          { id: 'cfg', label: 'CFG Scale', options: ['5', '7', '9', '12'] }
        ],
        formatPrompt: (prompt, params) => prompt + ', ' + params.join(', '),
        formatNegative: (neg) => neg
      }
    };

    // Style references
    const styleReferences = {
      "Render fotorrealista": "Style reference: photorealistic architectural rendering, physically based materials, global illumination, ray-traced lighting, realistic textures, high dynamic range, natural microcontrast, real lens behavior, 8K detail, ultra high fidelity, cinematic quality.",
      "Visualización conceptual": "Style reference: conceptual architectural visualization, artistic rendering, stylized realism, clean geometry, soft lighting, muted color palette, professional presentation, design-focused aesthetics.",
      "Axonometría": "Style reference: axonometric projection, parallel lines preserved, no perspective distortion, architectural technical drawing, clean linework, precise geometry, professional diagram style, measured drawing aesthetic.",
      "Vista isométrica": "Style reference: isometric projection, 30-degree angle view, parallel lines, architectural diagram, clean geometric forms, technical illustration style, precise proportions, professional presentation.",
      "Corte arquitectónico": "Style reference: architectural section drawing, cutaway view, interior details visible, technical precision, labeled elements, construction details, professional blueprint aesthetic, section line hatching.",
      "Planta arquitectónica amueblada": "Style reference: architectural floor plan, furnished layout, top-down view, furniture icons, room labels, dimension lines, professional drafting style, clean linework, architectural symbols.",
      "Planta esquemática": "Style reference: schematic floor plan, simplified layout, minimal detail, diagrammatic style, basic shapes, clear circulation paths, architectural zoning diagram, professional presentation.",
      "Diagrama volumétrico": "Style reference: volumetric diagram, 3D massing study, abstract architectural forms, solid geometry, spatial relationships, exploded view potential, professional architectural analysis, clean representation.",
      "Render estilo maqueta": "Style reference: architectural model photography, miniature aesthetic, crafted appearance, textured materials, museum quality, basswood aesthetic, precise craftsmanship, scale model realism.",
      "Collage arquitectónico": "Style reference: architectural collage, mixed media aesthetic, layered composition, artistic textures, hand-drawn elements, photographic cutouts, artistic presentation, creative visualization, post-digital style.",
      "Sketch arquitectónico": "Style reference: architectural freehand sketch, hand-drawn lines, gestural marks, pencil texture, paper grain, conceptual design aesthetic, loose but precise, artistic documentation style.",
      "Blueprint técnico": "Style reference: technical blueprint, white lines on blue background, engineering drawing, precise measurements, construction documentation, professional CAD aesthetic, detailed annotations, grid reference system."
    };

    const negativeAntagonists = {
      "Render fotorrealista": ["cartoonish style", "hand-drawn look", "unrealistic lighting", "exaggerated outlines", "sketch lines", "low detail", "flat shading", "non-physical materials", "painterly", "stylized"],
      "Visualización conceptual": ["photorealistic rendering", "over-detailed textures", "harsh shadows", "glossy reflections", "noisy details", "hyper-realistic"],
      "Axonometría": ["perspective distortion", "vanishing points", "photorealistic", "atmospheric perspective", "depth of field", "lens effects"],
      "Vista isométrica": ["perspective distortion", "vanishing points", "photorealistic", "atmospheric effects", "lens blur", "natural lighting"],
      "Corte arquitectónico": ["photorealistic", "perspective view", "atmospheric effects", "exterior context", "natural lighting", "rendered materials"],
      "Planta arquitectónica amueblada": ["3D perspective", "photorealistic", "cast shadows", "atmospheric effects", "rendered materials", "lens effects"],
      "Planta esquemática": ["detailed textures", "photorealistic", "3D elements", "shadows", "complex materials", "furniture details"],
      "Diagrama volumétrico": ["photorealistic textures", "detailed materials", "natural lighting", "lens effects", "cast shadows", "atmospheric perspective"],
      "Render estilo maqueta": ["photorealistic", "full-scale appearance", "outdoor lighting", "natural context", "lens effects", "realistic materials"],
      "Collage arquitectónico": ["photorealistic", "3D render", "clean digital", "uniform style", "hyper-detailed", "seamless textures"],
      "Sketch arquitectónico": ["photorealistic", "vector lines", "digital perfection", "hard edges", "uniform stroke", "rendered appearance"],
      "Blueprint técnico": ["photorealistic", "colored rendering", "artistic style", "hand-drawn", "textured paper", "gradient fills"]
    };

    const subjectOptions = {
      vivienda_interior: ["Salón", "Cocina", "Comedor", "Dormitorio", "Baño", "Aseo", "Vestidor", "Hall", "Terraza", "Loft", "Patio Interior"],
      vivienda_exterior: ["Edificio Residencial", "Vivienda Unifamiliar", "Torre Residencial", "Viviendas Pareadas", "Viviendas Adosadas"],
      edificacion_interior: ["Oficina", "Centro Comercial", "Centro Cultural", "Centro Educativo", "Escuela Infantil", "Religioso", "Deportivo", "Hotelero", "Consulta Medica", "Hospital", "Museo", "Espacio Público", "Estación de Tren", "Bar", "Restaurante", "Industrial"],
      edificacion_exterior: ["Oficina", "Centro Comercial", "Centro Cultural", "Centro Educativo", "Escuela Infantil", "Religioso", "Deportivo", "Hotelero", "Consulta Medica", "Hospital", "Museo", "Espacio Público", "Estación de Tren", "Bar", "Restaurante", "Industrial"]
    };

    const negativePromptOptions = [
      "low-res", "blurry", "out of focus", "overexposed", "underexposed", 
      "harsh shadows", "blown highlights", "color cast", "chromatic aberration", 
      "incorrect perspective", "jagged edges", "noise", "unrealistic scale", 
      "distorted geometry", "bad reflections", "incorrect refractions", 
      "over-sharpening", "poor lighting", "uneven exposure", "photorealistic artifacts"
    ];

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      const negContainer = document.getElementById('negativeCheckboxes');
      negativePromptOptions.forEach(opt => {
        const div = document.createElement('div');
        div.className = 'flex items-center space-x-2 p-2 rounded-lg hover:bg-slate-700/30 transition-colors';
        div.innerHTML = `
          <input type="checkbox" id="neg_${opt}" value="${opt}" class="w-4 h-4 rounded border-slate-500 bg-slate-900/50 text-rose-500 focus:ring-rose-500/30">
          <label for="neg_${opt}" class="text-sm text-slate-300 cursor-pointer hover:text-slate-100 transition-colors">${opt}</label>
        `;
        negContainer.appendChild(div);
      });
    });

    // Engine selection
    function selectEngine(engine) {
      selectedEngine = engine;
      const config = engineConfigs[engine];
      
      // Update UI - remove selected from all
      document.querySelectorAll('.model-card').forEach(card => {
        card.classList.remove('selected');
      });
      
      // Add selected to clicked card
      const cards = document.querySelectorAll('.model-card');
      const cardIndex = Object.keys(engineConfigs).indexOf(engine);
      if (cards[cardIndex]) {
        cards[cardIndex].classList.add('selected');
      }

      // Update badge
      const badge = document.getElementById('engineBadge');
      const badgeName = document.getElementById('engineBadgeName');
      badge.classList.remove('hidden');
      badgeName.textContent = config.name;
      badgeName.className = 'px-3 py-1 rounded-full font-medium text-white';
      
      const colors = {
        midjourney: 'bg-gradient-to-r from-indigo-500 to-blue-600',
        stable_diffusion: 'bg-gradient-to-r from-emerald-500 to-green-600',
        dalle: 'bg-gradient-to-r from-amber-500 to-orange-600',
        leonardo: 'bg-gradient-to-r from-pink-500 to-rose-600',
        flux: 'bg-gradient-to-r from-cyan-500 to-teal-600',
        ideogram: 'bg-gradient-to-r from-violet-500 to-purple-600',
        nano_banana: 'bg-gradient-to-r from-yellow-400 to-yellow-600',
        recraft: 'bg-gradient-to-r from-teal-500 to-cyan-600',
        runway: 'bg-gradient-to-r from-indigo-500 to-blue-600',
        firefly: 'bg-gradient-to-r from-red-500 to-orange-600',
        playground: 'bg-gradient-to-r from-sky-400 to-blue-600',
        titan: 'bg-gradient-to-r from-orange-500 to-amber-600'
      };
      badgeName.classList.add(...colors[engine].split(' '));

      // Show parameters
      const paramsContainer = document.getElementById('engineParams');
      const paramFields = document.getElementById('paramFields');
      document.getElementById('engineNameParam').textContent = config.name;
      
      paramFields.innerHTML = '';
      config.params.forEach(param => {
        paramFields.innerHTML += `
          <div>
            <label class="text-xs text-slate-400 mb-1 block">${param.label}</label>
            <select id="param_${param.id}" class="w-full bg-slate-900/50 border border-slate-600/50 text-slate-200 rounded-lg p-2 text-sm focus:outline-none focus:ring-2 focus:ring-slate-500/30">
              <option value="">Default</option>
              ${param.options.map(opt => `<option value="${opt}">${opt}</option>`).join('')}
            </select>
          </div>
        `;
      });
      paramsContainer.classList.remove('hidden');

      // Show info
      document.getElementById('engineDescription').textContent = config.description;
      document.getElementById('engineTip').textContent = '💡 ' + config.tip;
      document.getElementById('engineInfo').classList.remove('hidden');
    }

    // Tab switching
    function showTab(tabName) {
      document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
      document.querySelectorAll('.tab-btn').forEach(el => {
        el.classList.remove('tab-active');
        el.classList.add('bg-slate-800/50', 'text-slate-300');
      });
      
      document.getElementById('content-' + tabName).classList.remove('hidden');
      document.getElementById('content-' + tabName).classList.add('fade-in');
      
      const activeTab = document.getElementById('tab-' + tabName);
      activeTab.classList.add('tab-active');
      activeTab.classList.remove('bg-slate-800/50', 'text-slate-300');
    }

    // Update subjects
    function updateSujetos() {
      const tipoVista = document.getElementById('tipoVista').value;
      const sujetoSelect = document.getElementById('sujeto');
      
      sujetoSelect.innerHTML = '<option value="">Seleccionar...</option>';
      
      if (tipoVista && subjectOptions[tipoVista]) {
        sujetoSelect.disabled = false;
        subjectOptions[tipoVista].forEach(opt => {
          const option = document.createElement('option');
          option.value = opt;
          option.textContent = opt;
          sujetoSelect.appendChild(option);
        });
      } else {
        sujetoSelect.disabled = true;
        sujetoSelect.innerHTML = '<option value="">Primero selecciona tipo de vista</option>';
      }
    }

    // Generate prompts
    function generatePrompts() {
      if (!selectedEngine) {
        alert('Por favor, selecciona un motor de IA en la pestaña "Motor IA"');
        return;
      }

      const parts = [];
      const config = engineConfigs[selectedEngine];
      
      // Get all values
      const tipoImagen = document.getElementById('tipoImagen').value;
      if (tipoImagen) {
        parts.push(`tipo de representación: ${tipoImagen}`);
        if (styleReferences[tipoImagen]) parts.push(styleReferences[tipoImagen]);
      }
      
      const tipoVista = document.getElementById('tipoVista').value;
      if (tipoVista) {
        const vistaLabel = {
          'vivienda_interior': 'vista interior de vivienda',
          'vivienda_exterior': 'vista exterior de vivienda', 
          'edificacion_interior': 'vista interior de edificación',
          'edificacion_exterior': 'vista exterior de edificación'
        };
        parts.push(`tipo de vista: ${vistaLabel[tipoVista]}`);
      }
      
      const sujeto = document.getElementById('sujeto').value;
      if (sujeto) parts.push(`sujeto: ${sujeto}`);
      
      const estilo = document.getElementById('estiloArquitectonico').value;
      if (estilo) parts.push(`estilo arquitectónico: ${estilo}`);
      
      const plano = document.getElementById('tipoPlano').value;
      if (plano) parts.push(`tipo de plano: ${plano}`);
      
      const angulo = document.getElementById('angulo').value;
      if (angulo) parts.push(`ángulo: ${angulo}`);
      
      const entorno = document.getElementById('entorno').value;
      if (entorno) parts.push(`entorno: ${entorno}`);
      
      const localizacion = document.getElementById('localizacion').value;
      if (localizacion) parts.push(`localización: ${localizacion}`);
      
      const iluminacion = document.getElementById('iluminacion').value;
      if (iluminacion) parts.push(`iluminación: ${iluminacion}`);
      
      const mobiliario = document.getElementById('mobiliario').value;
      if (mobiliario) parts.push(`mobiliario: ${mobiliario}`);
      
      const personas = document.getElementById('personas').value;
      if (personas) parts.push(`personas: ${personas}`);
      
      const clima = document.getElementById('clima').value;
      if (clima) parts.push(`clima: ${clima}`);
      
      const trafico = document.getElementById('trafico').value;
      if (trafico) parts.push(`tráfico: ${trafico}`);
      
      const tipoFotografia = document.getElementById('tipoFotografia').value;
      if (tipoFotografia) parts.push(`tipo de fotografía: ${tipoFotografia}`);
      
      const balance = document.getElementById('balanceBlancos').value;
      if (balance) parts.push(`balance de blancos: ${balance}`);
      
      const camara = document.getElementById('camara').value;
      if (camara) parts.push(`cámara: ${camara}`);
      
      const composicion = document.getElementById('composicion').value;
      if (composicion) parts.push(`composición fotográfica: ${composicion}`);
      
      const materiales = document.getElementById('materiales').value.trim();
      if (materiales) parts.push(`materiales: ${materiales}`);
      
      const notas = document.getElementById('notasAdicionales').value.trim();
      if (notas) parts.push(`notas: ${notas}`);

      // Control de texto - Añadir al prompt positivo para mayor efectividad
      const sinTexto = document.getElementById('sinTexto')?.checked;
      const sinWatermark = document.getElementById('sinWatermark')?.checked;
      
      // Text control flags for later use in negative prompt
      const textControlFlags = { sinTexto, sinWatermark };
      
      // Añadir instrucciones de control de texto al prompt positivo
      if (sinTexto) {
        parts.push('sin texto en la imagen, image without text, no letters, no words, text-free');
      }
      if (sinWatermark) {
        parts.push('sin marcas de agua, no watermark, no logo, clean image');
      }

      // Get engine params
      const engineParams = [];
      config.params.forEach(param => {
        const val = document.getElementById('param_' + param.id)?.value;
        if (val) engineParams.push(val);
      });

      // Add template style if active
      if (window.activeTemplate) {
        parts.push(window.activeTemplate.styleAdd);
      }

      // Format positive prompt
      let basePrompt = parts.join(', ');
      let finalPrompt = config.formatPrompt(basePrompt, engineParams);

      document.getElementById('promptPositivo').value = finalPrompt;

      // Generate negative prompt
      const negParts = [];
      document.querySelectorAll('#negativeCheckboxes input:checked').forEach(cb => negParts.push(cb.value));

      if (tipoImagen && negativeAntagonists[tipoImagen]) {
        negParts.push(...negativeAntagonists[tipoImagen]);
      }

      // Add template negatives if active
      if (window.activeTemplate && window.activeTemplate.negativeAdd) {
        negParts.push(...window.activeTemplate.negativeAdd);
      }

      // Add text control to negative prompt
      if (textControlFlags.sinTexto) {
        negParts.push('text', 'words', 'letters', 'typography', 'writing', 'captions', 'labels', 'numbers', 'script', 'inscription');
      }
      if (textControlFlags.sinWatermark) {
        negParts.push('watermark', 'logo', 'signature', 'stamp', 'copyright symbol', 'brand mark', 'text overlay', 'credits');
      }

      const negAdicional = document.getElementById('negativoAdicional').value.trim();
      if (negAdicional) negParts.push(negAdicional);

      // Format negative based on engine
      const baseNegative = negParts.join(', ');
      let finalNegative = config.formatNegative(baseNegative);

      if (selectedEngine === 'dalle') {
        document.getElementById('promptNegativo').value = '(DALL-E no soporta prompts negativos directamente)';
      } else {
        document.getElementById('promptNegativo').value = finalNegative || baseNegative;
      }
    }

    // Templates definitions
    const templates = {
      'golden-hour': {
        name: 'Golden Hour',
        values: {
          iluminacion: 'hora dorada',
          clima: 'verano soleado',
          estiloArquitectonico: 'contemporáneo'
        },
        styleAdd: 'warm golden light, long dramatic shadows, cinematic atmosphere, amber tones, soft contrast, beautiful sunset colors',
        negativeAdd: ['cold light', 'harsh shadows', 'blue tones', 'overcast', 'midday sun']
      },
      'blue-hour': {
        name: 'Blue Hour',
        values: {
          iluminacion: 'luz de luna',
          clima: 'día nublado'
        },
        styleAdd: 'deep blue twilight sky, soft ambient glow, serene atmosphere, city lights beginning to glow, cool blue tones, tranquil mood',
        negativeAdd: ['harsh sunlight', 'warm colors', 'bright day', 'golden hour', 'strong shadows']
      },
      'rain-dramatic': {
        name: 'Lluvia dramática',
        values: {
          iluminacion: 'luz difusa',
          clima: 'ambiente húmedo'
        },
        styleAdd: 'wet surfaces with reflections, dramatic moody atmosphere, rain puddles, overcast sky, glossy materials, water droplets, cinematic rain',
        negativeAdd: ['sunny', 'dry surfaces', 'bright colors', 'clear sky', 'warm tones']
      },
      'fog-atmospheric': {
        name: 'Niebla atmosférica',
        values: {
          iluminacion: 'luz difusa',
          clima: 'niebla matinal'
        },
        styleAdd: 'atmospheric fog, depth and mystery, soft diffused light, limited visibility, ethereal mood, volumetric fog, mysterious atmosphere',
        negativeAdd: ['clear visibility', 'harsh light', 'strong contrast', 'bright colors', 'sharp details']
      },
      'winter-snow': {
        name: 'Invierno nevado',
        values: {
          iluminacion: 'luz natural',
          clima: 'invierno nevado'
        },
        styleAdd: 'pristine white snow, cold serene atmosphere, soft winter light, snow-covered landscape, frost details, peaceful winter scene',
        negativeAdd: ['summer', 'green grass', 'warm colors', 'sunny day', 'flowers']
      },
      'night-neon': {
        name: 'Noche urbana',
        values: {
          iluminacion: 'noche con luces de neón'
        },
        styleAdd: 'neon lights, cyberpunk atmosphere, vibrant colored lights, urban night scene, dramatic contrasts, glowing signs, moody night',
        negativeAdd: ['daylight', 'natural light', 'soft colors', 'rural setting', 'sunny']
      },
      'cinematic': {
        name: 'Cinematográfico',
        values: {
          tipoFotografia: 'cineStill',
          estiloArquitectonico: 'moderno'
        },
        styleAdd: 'anamorphic lens flare, widescreen aspect, dramatic lighting, film color grading, hollywood style, cinematic composition, movie still aesthetic',
        negativeAdd: ['amateur photo', 'flat lighting', 'snapshot', 'casual', 'documentary style']
      },
      'minimalist-clean': {
        name: 'Minimalista limpio',
        values: {
          estiloArquitectonico: 'minimalista'
        },
        styleAdd: 'clean composition, neutral colors, simple geometry, pure forms, white space, minimalist aesthetic, uncluttered design, zen simplicity',
        negativeAdd: ['clutter', 'ornate details', 'busy composition', 'bright colors', 'complex patterns']
      },
      'editorial-premium': {
        name: 'Editorial premium',
        values: {
          tipoFotografia: 'publicitaria de estudio',
          estiloArquitectonico: 'contemporáneo'
        },
        styleAdd: 'premium magazine quality, studio lighting, high-end finish, luxury real estate photography, polished surfaces, editorial style, sophisticated aesthetic',
        negativeAdd: ['amateur', 'casual', 'snapshot', 'low quality', 'amateur lighting']
      },
      'sunrise': {
        name: 'Amanecer',
        values: {
          iluminacion: 'amanecer',
          clima: 'ambiente húmedo'
        },
        styleAdd: 'pink and orange sky, fresh morning atmosphere, soft early light, dew on surfaces, hopeful mood, gentle morning colors, awakening light',
        negativeAdd: ['sunset', 'golden hour', 'harsh light', 'night', 'overcast']
      },
      'midday-bright': {
        name: 'Mediodía',
        values: {
          iluminacion: 'luz natural',
          clima: 'verano soleado'
        },
        styleAdd: 'bright direct sunlight, harsh shadows, clear blue sky, high contrast, vibrant colors, strong directional light, sharp details',
        negativeAdd: ['soft light', 'overcast', 'sunset', 'sunrise', 'diffused light']
      },
      'sketch-artistic': {
        name: 'Sketch artístico',
        values: {
          tipoImagen: 'Sketch arquitectónico'
        },
        styleAdd: 'hand-drawn aesthetic, pencil lines, artistic rendering, loose but precise strokes, conceptual design drawing, paper texture, sketchbook style',
        negativeAdd: ['photorealistic', 'digital render', '3D', 'vector', 'clean lines']
      },
      'ethereal-dreamy': {
        name: 'Onírico/Etérico',
        values: {
          iluminacion: 'luz difusa'
        },
        styleAdd: 'soft glows, light leaks, pastel colors, fantasy-like atmosphere, magical mood, dreamy quality, ethereal lighting, romantic aesthetic',
        negativeAdd: ['harsh light', 'strong contrast', 'dark mood', 'sharp edges', 'vibrant colors']
      }
    };

    // Filter templates by category
    function filterTemplates(category) {
      const cards = document.querySelectorAll('.template-card');
      const buttons = document.querySelectorAll('.template-filter-btn');

      // Update button styles
      buttons.forEach(btn => {
        if (btn.dataset.filter === category) {
          btn.classList.remove('bg-slate-700/30', 'text-slate-400', 'border-slate-600/30');
          btn.classList.add('bg-pink-500/20', 'text-pink-300', 'border-pink-500/30', 'active');
        } else {
          btn.classList.add('bg-slate-700/30', 'text-slate-400', 'border-slate-600/30');
          btn.classList.remove('bg-pink-500/20', 'text-pink-300', 'border-pink-500/30', 'active');
        }
      });

      // Filter cards
      cards.forEach(card => {
        const categories = card.dataset.category.split(' ');
        if (category === 'all' || categories.includes(category)) {
          card.classList.remove('hidden');
        } else {
          card.classList.add('hidden');
        }
      });
    }

    // Apply template
    function applyTemplate(templateId) {
      const template = templates[templateId];
      if (!template) return;

      // Apply values to form fields
      Object.keys(template.values).forEach(key => {
        const element = document.getElementById(key);
        if (element) {
          element.value = template.values[key];
          // Trigger change event for dependent fields
          if (key === 'tipoVista') {
            updateSujetos();
          }
        }
      });

      // Store additional style for prompt generation
      window.activeTemplate = template;

      // Show confirmation
      const notice = document.getElementById('templateApplied');
      const text = document.getElementById('templateAppliedText');
      text.textContent = `Plantilla "${template.name}" aplicada correctamente`;
      notice.classList.remove('hidden');

      // Highlight selected card
      document.querySelectorAll('.template-card').forEach(card => {
        card.classList.remove('ring-2', 'ring-pink-500');
      });
      event.currentTarget.classList.add('ring-2', 'ring-pink-500');

      // Hide notice after 3 seconds
      setTimeout(() => {
        notice.classList.add('hidden');
      }, 3000);
    }

    // Clear all
    function clearAll() {
      document.querySelectorAll('select').forEach(s => s.value = '');
      document.querySelectorAll('textarea').forEach(t => t.value = '');
      document.querySelectorAll('input[type="checkbox"]').forEach(c => c.checked = false);
      document.getElementById('sujeto').disabled = true;
      document.getElementById('sujeto').innerHTML = '<option value="">Primero selecciona tipo de vista</option>';

      // Reset engine selection
      selectedEngine = null;
      document.querySelectorAll('.model-card').forEach(card => card.classList.remove('selected'));
      document.getElementById('engineParams').classList.add('hidden');
      document.getElementById('engineInfo').classList.add('hidden');
      document.getElementById('engineBadge').classList.add('hidden');

      // Reset template selection
      window.activeTemplate = null;
      document.querySelectorAll('.template-card').forEach(card => card.classList.remove('ring-2', 'ring-pink-500'));
      const templateNotice = document.getElementById('templateApplied');
      if (templateNotice) templateNotice.classList.add('hidden');
    }

    // Copy text
    function copyText(id) {
      const text = document.getElementById(id).value;
      navigator.clipboard.writeText(text).then(() => {
        const btn = id === 'promptPositivo' ? document.getElementById('copyPosBtn') : document.getElementById('copyNegBtn');
        const original = btn.innerHTML;
        btn.innerHTML = '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg> Copiado!';
        setTimeout(() => btn.innerHTML = original, 2000);
      });
    }

    // Reset Idea Form - Reiniciar formulario de sugerencias
    function resetIdeaForm() {
      document.getElementById('ideasForm').classList.remove('hidden');
      document.getElementById('ideaSuccess').classList.add('hidden');
      document.getElementById('ideaNombre').value = '';
      document.getElementById('ideaEmail').value = '';
      document.getElementById('ideaSeccion').value = '';
      document.getElementById('ideaTexto').value = '';
    }

    // Submit Idea Form - Envío de sugerencias
    document.getElementById('ideasForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const nombre = document.getElementById('ideaNombre').value || 'Anónimo';
      const email = document.getElementById('ideaEmail').value || 'No proporcionado';
      const seccion = document.getElementById('ideaSeccion').value || 'No especificada';
      const texto = document.getElementById('ideaTexto').value;
      
      if (!texto.trim()) {
        alert('Por favor, escribe tu sugerencia');
        return;
      }
      
      // Mostrar estado de envío
      const submitBtn = document.querySelector('#ideasForm button[type="submit"]');
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = '<svg class="w-5 h-5 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg> Enviando...';
      submitBtn.disabled = true;
      
      try {
        // Enviar usando FormSubmit (servicio gratuito)
        const formData = new FormData();
        formData.append('name', nombre);
        formData.append('email', email);
        formData.append('_subject', `Nueva sugerencia - ${seccion}`);
        formData.append('message', `
SECCIÓN: ${seccion}
NOMBRE: ${nombre}
EMAIL: ${email}

SUGERENCIA:
${texto}
        `);
        formData.append('_captcha', 'false');
        formData.append('_template', 'table');
        
        const response = await fetch('https://formsubmit.co/ajax/trabajosen3d@gmail.com', {
          method: 'POST',
          body: formData
        });
        
        const result = await response.json();
        
        if (result.success === 'true' || response.ok) {
          // Mostrar mensaje de éxito
          document.getElementById('ideasForm').classList.add('hidden');
          document.getElementById('ideaSuccess').classList.remove('hidden');
          
          // Limpiar formulario
          document.getElementById('ideaNombre').value = '';
          document.getElementById('ideaEmail').value = '';
          document.getElementById('ideaSeccion').value = '';
          document.getElementById('ideaTexto').value = '';
        } else {
          throw new Error('Error en el envío');
        }
        
      } catch (error) {
        console.error('Error:', error);
        
        // Fallback: abrir cliente de correo
        const subject = encodeURIComponent(`Nueva sugerencia - ${seccion}`);
        const body = encodeURIComponent(
          `Sección: ${seccion}\nNombre: ${nombre}\nEmail: ${email}\n\nSugerencia:\n${texto}`
        );
        
        if (confirm('Hubo un problema con el envío automático. ¿Deseas abrir tu cliente de correo para enviar la sugerencia manualmente?')) {
          window.location.href = `mailto:trabajosen3d@gmail.com?subject=${subject}&body=${body}`;
        }
      } finally {
        // Restaurar botón
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
      }
    });

    // ============================================
    // API CONFIGURATION
    // ============================================
    const API_BASE_URL = 'https://archviz-api-v2.vercel.app';
    let apiUserData = null;
    let apiRequiresKey = false; // Cambiar a true para requerir API Key obligatoriamente

    // ============================================
    // VALIDATE API KEY
    // ============================================
async function validateApiKey() {
    const apiKey = document.getElementById('apiKey').value.trim();
    const statusDiv = document.getElementById('apiStatus');
    
    if (!apiKey) {
        showApiStatus('Introduce una API Key', 'error');
        return;
    }

    statusDiv.className = 'mt-2 text-center text-sm text-slate-400 block';
    statusDiv.textContent = 'Validando...';

    try {
        // CAMBIO CLAVE: Usamos ruta relativa '/api/validate' para evitar errores de CORS
        const response = await fetch('/api/validate', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ api_key: apiKey })
        });

        // Verificamos si la respuesta es JSON antes de leerla
        const contentType = response.headers.get("content-type");
        if (contentType && contentType.includes("application/json")) {
            const data = await response.json();
            if (data.success) {
                apiUserData = data;
                showApiStatus(`Plan: ${data.plan} | Tokens: ${data.tokens_remaining}`, 'success');
            } else {
                showApiStatus(data.error || 'API Key inválida', 'error');
            }
        } else {
            // Si el servidor falla (Error 500) y no manda JSON
            showApiStatus('Error del servidor (500). Revisa las variables de entorno.', 'error');
        }
    } catch (error) {
        console.error('Error:', error);
        showApiStatus('Error de conexión con el servidor', 'error');
    }
}
    
    function showApiStatus(message, type) {
      const statusDiv = document.getElementById('apiStatus');
      statusDiv.classList.remove('hidden');
      
      if (type === 'success') {
        statusDiv.innerHTML = '<span class="text-emerald-400">✓ ' + message + '</span>';
      } else if (type === 'error') {
        statusDiv.innerHTML = '<span class="text-rose-400">✗ ' + message + '</span>';
      } else {
        statusDiv.innerHTML = '<span class="text-slate-400">' + message + '</span>';
      }
    }

    // ============================================
    // WRAPPED GENERATE PROMPTS WITH API SUPPORT
    // ============================================
    const _originalGeneratePrompts = generatePrompts;
    
    generatePrompts = async function generatePrompt() {
    const apiKey = document.getElementById('apiKey').value;
    
    if (!apiKey) {
        showApiStatus('Introduce una API Key para generar', 'error');
        return;
    }

    const btn = document.querySelector('button[onclick="generatePrompt()"]');
    btn.disabled = true;
    const originalText = btn.innerHTML;
    btn.innerHTML = '<span class="animate-spin mr-2">⏳</span> Conectando...';

    showApiStatus('Validando con el servidor...', 'info');

    // Recolectar todos tus selectores (Asegúrate de que los IDs coincidan con tu HTML)
    const promptData = {
        scene: document.getElementById('scene-select')?.value,
        lighting: document.getElementById('lighting-select')?.value,
        weather: document.getElementById('weather-select')?.value,
        camera: document.getElementById('camera-select')?.value,
        composition: document.getElementById('composition-select')?.value,
        materials: document.getElementById('materials-select')?.value,
        render: document.getElementById('render-select')?.value,
        style: document.getElementById('style-select')?.value,
        extra: document.getElementById('extra-select')?.value
    };

    try {
        // Llamada a tu API en Vercel
// Dentro de la función que genera el prompt, cambia la línea del fetch por esta:
const response = await fetch('/api/generate', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer ' + apiKey
    },
    body: JSON.stringify({
        api_key: apiKey,
        prompt_data: promptData,
        engine: selectedEngine
    })
});

        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.error || 'Error en el servidor');
        }

        const data = await response.json();

        if (data.success) {
            // Rellenar tus cuadros de texto originales
            document.getElementById('promptPositivo').value = data.prompt;
            
            if (selectedEngine === 'dalle') {
                document.getElementById('promptNegativo').value = '(DALL-E no usa prompts negativos)';
            } else {
                document.getElementById('promptNegativo').value = data.negative_prompt;
            }
            
            // Actualizar el estado con los datos reales de Supabase
            showApiStatus('Plan: ' + data.plan + ' | Tokens: ' + data.tokens_remaining + ' restantes', 'success');
        } else {
            showApiStatus(data.error, 'error');
        }

    } catch (error) {
        console.error('Error detallado:', error);
        // Aquí es donde te daba el error antes. Ahora somos más específicos.
        showApiStatus('Error: ' + error.message, 'error');
    } finally {
        btn.disabled = false;
        btn.innerHTML = originalText;
    }
};
    
    async function generatePromptsWithApi(apiKey) {
      if (!selectedEngine) {
        alert('Por favor, selecciona un motor de IA en la pestana "Motor IA"');
        return;
      }
      
      // Recopilar datos del formulario
      const promptData = {
        tipoRepresentacion: document.getElementById('tipoImagen').value,
        tipoVista: document.getElementById('tipoVista').value,
        sujeto: document.getElementById('sujeto').value,
        estiloArquitectonico: document.getElementById('estiloArquitectonico').value,
        tipoPlano: document.getElementById('tipoPlano').value,
        angulo: document.getElementById('angulo').value,
        entorno: document.getElementById('entorno').value,
        localizacion: document.getElementById('localizacion').value,
        iluminacion: document.getElementById('iluminacion').value,
        mobiliario: document.getElementById('mobiliario').value,
        personas: document.getElementById('personas').value,
        clima: document.getElementById('clima').value,
        trafico: document.getElementById('trafico').value,
        tipoFotografia: document.getElementById('tipoFotografia').value,
        balanceBlancos: document.getElementById('balanceBlancos').value,
        camara: document.getElementById('camara').value,
        composicion: document.getElementById('composicion').value,
        materiales: document.getElementById('materiales').value,
        notas: document.getElementById('notasAdicionales').value,
        sinTexto: document.getElementById('sinTexto') ? document.getElementById('sinTexto').checked : false,
        sinWatermark: document.getElementById('sinWatermark') ? document.getElementById('sinWatermark').checked : false
      };
      
      // Añadir template si esta activo
      if (window.activeTemplate) {
        promptData.templateStyle = window.activeTemplate.styleAdd;
        if (window.activeTemplate.negativeAdd) {
          promptData.templateNegatives = window.activeTemplate.negativeAdd;
        }
      }
      
      // Añadir negativos seleccionados
      const negativos = [];
      document.querySelectorAll('#negativeCheckboxes input:checked').forEach(function(cb) { negativos.push(cb.value); });
      if (negativos.length > 0) promptData.negativos = negativos;
      
      // Negativo adicional
      const negAdicional = document.getElementById('negativoAdicional').value.trim();
      if (negAdicional) promptData.negativoAdicional = negAdicional;
      
      try {
        const response = await fetch(API_BASE_URL + '/api/generate', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer ' + apiKey
          },
          body: JSON.stringify({
            api_key: apiKey,
            prompt_data: promptData,
            engine: selectedEngine
          })
        });
        
        const data = await response.json();
        
        if (data.success) {
          // Mostrar resultados
          document.getElementById('promptPositivo').value = data.prompt;
          
          if (selectedEngine === 'dalle') {
            document.getElementById('promptNegativo').value = '(DALL-E no soporta prompts negativos directamente)';
          } else {
            document.getElementById('promptNegativo').value = data.negative_prompt;
          }
          
          // Actualizar info de tokens
          apiUserData.tokens_remaining = data.tokens_remaining;
          showApiStatus('Plan: ' + apiUserData.plan + ' | Tokens: ' + data.tokens_remaining + ' restantes', 'success');
        } else {
          showApiStatus(data.error, 'error');
          if (data.error.includes('cuota') || data.error.includes('agotado')) {
            alert('Has agotado tu cuota de tokens. Por favor, contacta para obtener mas.');
          }
        }
      } catch (error) {
        console.error('Error generating prompt:', error);
      }
    }

  </script>
</body>
</html>







